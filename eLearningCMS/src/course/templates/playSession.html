{% extends "__ecBase.html" %}
<html>
    {% load staticfiles %}

	{% block ImageSlider %}
    {% endblock ImageSlider %}

    {% block jumbotronBlock %}
    {% endblock jumbotronBlock %}

    {% block container %}

	{% block content %}
	<script src="{% static 'access/access.js' %}"></script>

<div class="container-full">
	<div class="row">
			<div class="col-8">
				<h2>{{ course.name }}</h2>
				<div class="jwplayerDiv">
				<iframe id="jwplayer" width="720" height="405" frameborder="30" scrolling="auto" allowfullscreen style="position:absolute;"></iframe>
				</div>
			</div>
			<div class="col-4">
				<h2>Contents</h2>
				{% for subj, subjdetails in coursedetails.items %}
					<div class="card">
						<div class="card-header">
								<a class="card-link" data-toggle="collapse" data-parent="#accordion" href="#{{ subj }}">{{ subj }}</a>
						</div>
						<div id="{{ subj }}" class="collapse show">
						<div class="card-body">
					{% for s in subjdetails %}
					{% for chapid, chapdetails in s.items %}
						<a class="list-group-item">
								<i style="padding-right:10px"></i><b>{{ chapdetails.name }}</b></a>
						{% for session in chapdetails.sessions %}
						<a href="{% url 'course:playSession' chapid session.id %}" class="list-group-item">
										<i class="fa fa-play fa-fw" style="padding-right:10px"></i>{{ session.name }}</a>
					{% endfor %}
					{% endfor %}
				{% endfor %}
			</div>
		</div>
</div>
				{% endfor %}
		</div>
	</div>
</div>

	<script type="text/javascript">
	var position1;
	window.onload = function() {
	/*var pluginsLength = navigator.plugins.length;
	for(var i = 0; i < pluginsLength; i++) {
  	var t1 = navigator.plugins[i].name;
  	var t2 = navigator.plugins[i].filename;
  	var t3 = navigator.plugins[i].description;
	}*/
	//var deviceJSON = getDeviceInfo();
	var width = screen.width;
	var height = screen.height;
	// Adding system fonts in device info. We will add more data 
	var deviceJSON = getFontsInstalled();
	var url = window.location.protocol + "//" + window.location.hostname + ":" + window.location.port + "/access/allow/{{user.id}}/" + deviceJSON;
	var xmlHttp = new XMLHttpRequest();
	xmlHttp.open("GET", url, false);
    xmlHttp.send(null);
	
	var accepted = (/True/).test(xmlHttp.responseText);
	if (accepted) {
	  document.getElementById("jwplayer").src = "{{ signedurl }}";
	}
	else {
	  alert("This device is unknown. Authenticate yourself by the link sent to your email.");
	}
    }


    </script>
    {%  endblock %}
	{%  endblock container %}
</html>

